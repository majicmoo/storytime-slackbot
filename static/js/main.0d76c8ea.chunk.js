(this["webpackJsonpstory-maker"]=this["webpackJsonpstory-maker"]||[]).push([[0],{11:function(e,t,n){e.exports=n(19)},16:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),i=n.n(o),d=(n(16),n(7)),c=n(1),s=n(2),u=n(3),l=n(5),p=n(4),f=n(6),m=(n(17),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).ref=Object(a.createRef)(),n.startDragging=function(e){console.log("click"),n.ref.current&&n.setState({dragging:!0,relX:e.pageX-n.ref.current.offsetLeft,relY:e.pageY-n.ref.current.offsetTop})},n.stopDragging=function(){n.setState({dragging:!1})},n.drag=function(e){var t=e.pageX-n.state.relX,a=e.pageY-n.state.relY;n.state.dragging&&(n.setState({x:t,y:a}),n.props.onUpdatePosition(t,a))},n.state={x:e.x,y:e.y,dragging:!1,relX:0,relY:0},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onUpdatePosition(this.props.x,this.props.y)}},{key:"componentDidUpdate",value:function(e,t){this.state.dragging&&!t.dragging?(document.addEventListener("mousemove",this.drag),document.addEventListener("mouseup",this.stopDragging)):!this.state.dragging&&t.dragging&&(document.removeEventListener("mousemove",this.drag),document.removeEventListener("mouseup",this.stopDragging))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,a=this.state,o=a.x,i=a.y;return r.a.createElement("div",{className:n,style:{left:"".concat(o,"px"),top:"".concat(i,"px")},onMouseDown:this.startDragging,ref:this.ref},t)}}]),t}(r.a.Component)),h=function(e){var t=e.node,n=e.updateNode,a=e.addOption,o=e.x,i=e.y,d=e.addOrUpdateNodeTracker;return r.a.createElement(m,{className:"node",x:o,y:i,onUpdatePosition:function(e,n){return d(t.id,"Node",e,n)}},r.a.createElement("input",{value:t.statement,onChange:function(e){return n(Object(c.a)({},t,{statement:e.target.value}))}}),r.a.createElement("p",null,t.type),r.a.createElement("button",{onClick:function(){return a(t.id)}},"Add Option"))},b=function(e){var t=e.verb,n=e.addVerb;return r.a.createElement("div",{className:"verb"},r.a.createElement("p",null,t),r.a.createElement("button",{onClick:function(){return n(t)}},"+"))},v=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).addNode=function(e){return n.props.addNode(n.props.option,e)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.option,n=e.updateOption,a=e.x,o=e.y,i=e.addOrUpdateNodeTracker;return r.a.createElement(m,{className:"option",x:a,y:o,onUpdatePosition:function(e,n){return i(t.id,"StoryOption",e,n)}},r.a.createElement("p",null,"Option"),r.a.createElement("input",{value:t.item,onChange:function(e){return n(Object(c.a)({},t,{item:e.target.value}))}}),r.a.createElement("div",{className:"verbs"},r.a.createElement(b,{verb:"taste",addVerb:this.addNode}),r.a.createElement(b,{verb:"touch",addVerb:this.addNode}),r.a.createElement(b,{verb:"smell",addVerb:this.addNode}),r.a.createElement(b,{verb:"look",addVerb:this.addNode}),r.a.createElement(b,{verb:"listen",addVerb:this.addNode})))}}]),t}(r.a.Component),g=(n(18),function(e){var t=e.x1,n=e.y1,a=e.x2,o=e.y2;return r.a.createElement("svg",{width:"500",height:"500",className:"line-wrapper"},r.a.createElement("line",{x1:t,y1:n,x2:a,y2:o,className:"line",stroke:"black"}))}),O=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.nodeTracker,n=e.story,a=j(t,n),o=y(t,n);return r.a.createElement(r.a.Fragment,null,a.map((function(e,t){return r.a.createElement(g,Object.assign({},e,{key:"line-".concat(t)}))})),o.map((function(e,t){return r.a.createElement(g,Object.assign({},e,{key:"other-lines-".concat(t)}))})))}}]),t}(r.a.Component),y=function(e,t){return e.flatMap((function(n){var a=t.options.find((function(e){return e.id===n.id}));if(a){var r=[];return a.listenId&&r.push(k(a.listenId,e,n)),a.lookId&&r.push(k(a.lookId,e,n)),a.smellId&&r.push(k(a.smellId,e,n)),a.tasteId&&r.push(k(a.tasteId,e,n)),a.touchId&&r.push(k(a.touchId,e,n)),r}})).filter((function(e){return void 0!==e}))},k=function(e,t,n){var a=t.find((function(t){return t.id===e}));return a?N(n,a):void 0},j=function(e,t){return e.flatMap((function(n){var a=t.nodes.find((function(e){return e.id===n.id}));if(a)return E(e,a,n)})).filter((function(e){return void 0!==e}))},E=function(e,t,n){return t.optionIds.map((function(t){return e.find((function(e){return e.id===t}))})).filter((function(e){return void 0!==e})).map((function(e){return N(n,e)}))},N=function(e,t){return{x1:e.x,y1:e.y,x2:t.x,y2:t.y}},x=function(e){var t=e.story,n=e.nodeTracker,a=e.updateTitle,o=e.updateNode,i=e.updateOption,d=e.addOrUpdateNodeTracker,c=e.addOption,s=e.addNode;return r.a.createElement("div",null,r.a.createElement("input",{value:t.title,onChange:function(e){return a(e.target.value)}}),t.nodes.map((function(e,t){return r.a.createElement(h,{key:e.id,node:e,addOption:c,updateNode:o,addOrUpdateNodeTracker:d,x:t,y:t})})),t.options.map((function(e,t){return r.a.createElement(v,{option:e,key:e.id,updateOption:i,addOrUpdateNodeTracker:d,addNode:s,x:t,y:t})})),r.a.createElement(O,{story:t,nodeTracker:n}))},I=function(e){return r.a.createElement("div",null,r.a.createElement("p",null,JSON.stringify(e)))},T=n(21),w=n(22),S=function(e,t,n){var a=e.nodes,r=Object(w.a)(),o=[].concat(Object(d.a)(a),[{type:"Normal",statement:"",id:r,optionIds:[]}]),i=e.options.findIndex((function(e){return e.id===t.id})),s=Object(c.a)({},t,{},"taste"===n&&{tasteId:r},{},"touch"===n&&{touchId:r},{},"listen"===n&&{listenId:r},{},"look"===n&&{lookId:r},{},"smell"===n&&{smellId:r}),u=Object(T.a)(i,s,e.options);return Object(c.a)({},e,{nodes:o,options:u})},U=function(e,t){var n=Object(w.a)(),a=e.options,r=e.nodes.find((function(e){return e.id===t})),o=Object(c.a)({},r,{optionIds:[].concat(Object(d.a)(r.optionIds),[n])}),i=[].concat(Object(d.a)(a),[{id:n,item:""}]);return Object(c.a)({},C(e,o),{options:i})},C=function(e,t){var n=e.nodes,a=n.findIndex((function(e){return e.id===t.id})),r=Object(T.a)(a,t,n);return Object(c.a)({},e,{nodes:r})},D=function(e,t){var n=e.options,a=n.findIndex((function(e){return e.id===t.id})),r=Object(T.a)(a,t,n);return Object(c.a)({},e,{options:r})},V=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={tab:"graph",story:{title:"",nodes:[{statement:"",type:"Normal",optionIds:[],id:"first-node"}],options:[]},nodeTracker:[]},n.updateTab=function(e){return n.setState({tab:e})},n.updateTitle=function(e){return n.setState({story:Object(c.a)({},n.state.story,{title:e})})},n.updateNode=function(e){n.setState({story:C(n.state.story,e)})},n.addOrUpdateNodeTracker=function(e,t,a,r){var o=n.state.nodeTracker,i=o.findIndex((function(t){return t.id===e})),c={id:e,x:a,y:r,type:t};-1===i?n.setState({nodeTracker:[].concat(Object(d.a)(o),[c])}):n.setState({nodeTracker:Object(T.a)(i,c,o)})},n.addNode=function(e,t){n.setState({story:S(n.state.story,e,t)})},n.addOption=function(e){n.setState({story:U(n.state.story,e)})},n.updateOption=function(e){n.setState({story:D(n.state.story,e)})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.tab,a=t.story,o=t.nodeTracker;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"tab-switcher"},r.a.createElement("button",{onClick:function(){return e.updateTab("graph")}},"Graph"),r.a.createElement("button",{onClick:function(){return e.updateTab("json")}},"JSON")),r.a.createElement("div",{className:"graph"===n?"":"tab--hidden"},r.a.createElement(x,{story:a,nodeTracker:o,updateTitle:this.updateTitle,updateNode:this.updateNode,addOption:this.addOption,addNode:this.addNode,updateOption:this.updateOption,addOrUpdateNodeTracker:this.addOrUpdateNodeTracker})),r.a.createElement("div",{className:"json"===n?"":"tab--hidden"},r.a.createElement(I,{story:a})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.0d76c8ea.chunk.js.map